!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.adjustSDK=e():t.adjustSDK=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={version:"js".concat("4.1.0"),baseUrl:"https://app.adjust.com"};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return"object"===o(t)&&null!==t}function i(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t+"",r=1;r<=e;r+=1)t<Math.pow(10,r)&&(n="0".concat(n));return n}function u(t){var e=function(t){var e=i(t.getDate()),n=i(t.getMonth()+1);return[t.getFullYear(),n,e].join("-")}(t=t||new Date),n=function(t){var e=i(t.getHours(),1),n=i(t.getMinutes()),r=i(t.getSeconds()),o=i(t.getMilliseconds(),2);return[e,n,r].join(":")+"."+o}(t),r=function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+i(Math.floor(Math.abs(e)/60))+i(Math.abs(e)%60)}(t);return"".concat(e,"T").concat(n,"Z").concat(r)}function c(t){var e=/Z/.test(t)?t.replace("Z",""):t;return new Date(e).getTime()}var s="adjustStore",f=function(){var t,e,n=(new Date).toString();try{return(t=window.localStorage).setItem(n,n),e=t.getItem(n)===n,t.removeItem(n),e&&t}catch(t){throw new Error("Local storage is not supported in this browser!")}}();function l(t,e){f.setItem("".concat(s,".").concat(t),JSON.stringify(e))}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=f.getItem("".concat(s,".").concat(t));return n?JSON.parse(n):e}var p={};function m(t,e){var n="id"+Math.random().toString(36).substr(2,16);return p[t]||(p[t]=[]),p[t].push({id:n,cb:e}),n}var v={long:{delay:12e4,maxDelay:864e5,minRange:.5,maxRange:1},short:{delay:200,maxDelay:36e5,minRange:.5,maxRange:1},test:{delay:100,maxDelay:300}};function g(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"long",o=v[r],a=o.delay*Math.pow(2,t-1);return a=Math.min(a,o.maxDelay),o.minRange&&o.maxRange&&(a*=(e=o.minRange,n=o.maxRange,Math.random()*(n-e)+e)),Math.round(a)}var b={id:null,attempts:0};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.adid||null,n=t.attribution||{};(function(t,e){var n=d("attribution",{});return!["tracker_token","tracker_name","network","campaign","adgroup","creative","click_label"].some(function(t){return n[t]!==e[t]})&&t===n.adid})(e,n)||(l("attribution",Object.assign({adid:e},n)),function(t,e){if(!p[t])return!1;p[t].forEach(function(n){n.cb(t,e)})}("attribution:change",t))}function y(t,e){return clearTimeout(b.id),new Promise(function(n){b.id=setTimeout(function(){return function(t,e){return T({url:"/attribution",params:Object.assign(e.base||e,{created_at:e.created_at})}).then(function(n){return t(_(n,e))}).catch(function(){return function(t){return b.attempts+=1,y(g(b.attempts),t)}(e)})}(n,e)},t)})}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return t.ask_in?(b.attempts=0,y(t.ask_in,e)):(h(t),Promise.resolve(t))}function j(t){return/\/attribution/.test(t)}function w(t,e){var n=t.response?JSON.parse(t.response):{},r=j(e)?["attribution","message"]:[];return["adid","timestamp","ask_in"].concat(r).filter(function(t){return n[t]}).reduce(function(t,e){return Object.assign(t,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,n[e]))},{})}function O(t,e){if(e)return JSON.parse(t.response);var n={error:"Unknown error, retry will follow"};return{status:t.status,statusText:t.statusText,response:n,responseText:JSON.stringify(n)}}function S(t){var e=t.base||{},n=t.other||{},r={created_at:u(),sent_at:u()};return t=t.base?Object.assign(r,e,n):Object.assign(r,t),Object.entries(t).filter(function(t){return a(t[1])?(e=t[1],!(!Object.keys(e).length&&e.constructor===Object)):!!t[1]||0===t[1];var e}).map(function(t){return t.map(function(t){return a(t)&&(t=JSON.stringify(t)),encodeURIComponent(t)}).join("=")}).join("&")}function k(t,e,n){var r=n.xhr,a=n.url;4===r.readyState&&(r.status>=200&&r.status<300?!function(t){try{return"object"===o(JSON.parse(t))}catch(t){return!1}}(r.response)?t(O(r)):e(w(r,a)):0===r.status?t(O(r)):e(O(r,!0)))}function x(t,e){return!j(e.url)&&t.ask_in&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.ask_in?(e.created_at=u(),_(t,e)):Promise.resolve(t)}(t,e.params),t}function T(t){return(e=t,n=e.url,o=e.method,a=void 0===o?"GET":o,i=e.params,u=S(void 0===i?{}:i),n=r.baseUrl+n,"GET"===a&&(n+="?".concat(u)),new Promise(function(t,e){var o=new XMLHttpRequest;o.open(a,n,!0),o.setRequestHeader("Client-SDK",r.version),"POST"===a&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){return k(e,t,{xhr:o,url:n})},o.onerror=function(){return e(O(o))},o.send("GET"===a?void 0:u)})).then(function(e){return x(e,t)});var e,n,o,a,i,u}var M={id:null,attempts:0,wait:150};function P(){var t=d("queue",[]);t.shift(),l("queue",t),M.attempts=0,M.wait=150,R()}function D(){M.attempts+=1,M.wait=g(M.attempts),R()}function R(t){t&&l("queue",d("queue",[]).filter(function(t){return function(t,e){if(!t||!e)return 0;var n=c(t),r=c(e),o=Math.abs(r-n);return Math.ceil(o/864e5)}(t.params.created_at,Date.now())<=28}));var e=d("queue",[])[0];clearTimeout(M.id),M.id=null,e&&(M.id=setTimeout(function(){return T(e).then(P).catch(D)},M.wait))}var E={push:function(t){var e=t.url,n=t.method,r=t.params,o=d("queue",[]);o.push({url:e,method:n,params:r}),l("queue",o),M.id||R()},run:R};var q=["app_token","environment","os_name"],N={app_token:"",environment:"",os_name:"",device_ids:{}};function J(){return Object.assign({app_token:N.app_token,environment:N.environment,os_name:N.os_name},N.device_ids)}function I(){return!!(N.app_token&&N.environment&&N.os_name)}function Y(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(t,e){return Object.assign(t,(n={},r=e.key,o=e.value,r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n));var n,r,o},{})}var H={getAppToken:function(){return N.app_token},getEnvironment:function(){return N.environment},getOsName:function(){return N.os_name},init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(I())throw new Error("You already initiated your instance");var n=function(t){var e=q.filter(function(e){return!t[e]});return e.length?"You must define ".concat(function(t){if(!t.length)return"";if(1===t.length)return t[0];var e=t.length-1,n=t.slice(0,e).join(", ");return"".concat(n," and ").concat(t[e])}(e)):""}(t);if(n)throw new Error(n);N=Object.assign({},t),"function"==typeof e&&m("attribution:change",e),E.run(!0)},trackSession:function(){if(!I())throw new Error("You must init your instance");E.push({url:"/session",method:"POST",params:Object.assign({created_at:u()},J())})},trackEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!I())throw new Error("You must init your instance");E.push({url:"/event",method:"POST",params:{base:Object.assign({created_at:u()},J()),other:Object.assign({event_token:t.eventToken,callback_params:Y(t.callbackParams),partner_params:Y(t.partnerParams)},(e=t.revenue,n=t.currency,(e=parseFloat(e))<0||!n?{}:{revenue:e.toFixed(5),currency:n}))}});var e,n},destroy:function(){N={app_token:"",environment:"",os_name:"",device_ids:{}},function(){for(var t in p)p.hasOwnProperty(t)&&delete p[t]}()}};Object.freeze(H);e.default=H}]).default});