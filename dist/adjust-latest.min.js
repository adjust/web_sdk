!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Adjust=t():e.Adjust=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function o(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.d(t,{default:()=>ur});var u=1e3,s=60*u,c=60*s,l=24*c,d=function(e){return e.REASON_GENERAL="general",e.REASON_GDPR="gdpr",e}({}),f={TRANSACTION_ERROR:"XHR transaction failed due to an error",SERVER_MALFORMED_RESPONSE:"Response from server is malformed",SERVER_INTERNAL_ERROR:"Internal error occurred on the server",SERVER_CANNOT_PROCESS:"Server was not able to process the request, probably due to error coming from the client",NO_CONNECTION:"No internet connectivity",SKIP:"Skipping slower attempt",MISSING_URL:"Url is not provided"},m=function(e){return e.NO_STORAGE="noStorage",e.INDEXED_DB="indexedDB",e.LOCAL_STORAGE="localStorage",e}({}),p={default:"adjust.com",india:"adjust.net.in",china:"adjust.world",world:"adjust.world",EU:"eu.adjust.com",TR:"tr.adjust.com",US:"us.adjust.com"},v="https://app.",h="https://gdpr.",g="https://",y={WEB_UUID_CREATED:"activity:web_uuid",ATTRIBUTION_RECEIVED:"activity:attribution"};function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){return!Object.keys(e).length&&e.constructor===Object}function P(e){return"object"===n(e)&&null!==e&&!(e instanceof Array)}function D(e){try{return P(JSON.parse(e))}catch(e){return!1}}function N(e,t,n){function r(e){return Array.isArray(t)?t.every((function(t){return e[t]===n[t]})):e[t]===n}for(var o=0;o<e.length;o+=1)if(r(e[o]))return o;return-1}function I(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){return a(a({},e),{},o({},t.key,t.value))}),{})}function E(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){return-1!==e.indexOf(t)}))}function O(e,t){return new RegExp("\\/".concat(t,"(\\/.*|\\?.*){0,1}$")).test(e)}function R(e,t){var n=S(t,2),r=n[0],i=n[1];return a(a({},e),{},o({},r,i))}function A(e){return Object.keys(e).map((function(t){return[t,e[t]]}))}function x(e){return Object.keys(e).map((function(t){return e[t]}))}function C(e){return P(e)?!w(e):!!e||0===e}function j(){try{var e=(new Date).toString(),t=window.localStorage;t.setItem(e,e);var n=t.getItem(e)===e;return t.removeItem(e),!(!n||!t)}catch(e){return!1}}const _={namespace:"adjust-sdk",version:"5.8.0",env:"production"};var T="error",B="warning",U="info",L="verbose",K=o(o(o(o(o({},"none",-1),T,0),B,1),U,2),L,3),q={log:"  ",info:" ",warn:" ",error:""},G={development:L,production:T,test:L},M=W(),F="";function W(){return G[_.env]||T}function V(e,t){var n;if(!(K[M]<K[t])){for(var r=(new Date).toISOString(),o=q[e],i=["[".concat(_.namespace,"]"),r,"".concat(e.toUpperCase(),":").concat(o)],a=F?document.querySelector(F):null,u=arguments.length,s=new Array(u>2?u-2:0),c=2;c<u;c++)s[c-2]=arguments[c];(n=console)[e].apply(n,i.concat(s)),a&&(a.textContent+="".concat(i.join(" ")," ").concat(s.map((function(e){return P(e)?JSON.stringify(e):e})).join(" "),"\n"),a.scrollTop=a.scrollHeight)}}function H(e,t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];V.apply(void 0,[e,t].concat(r))}}const Y={setLogLevel:function(e,t){e&&-1===Object.keys(K).indexOf(e)?V("error","error","You must set one of the available log levels: verbose, info, warning, error or none"):(M=e||W(),F=t||F,V("info",e,"Log level set to ".concat(M)))},log:H("log",L),info:H("info",U),warn:H("warn",B),error:H("error",T)};var z=null,J=null,Q=["appToken","environment"],X=[].concat(Q,["defaultTracker","externalDeviceId","storeInfo"]),Z=["customUrl","dataResidency","urlStrategy","eventDeduplicationListLimit","namespace"];function $(e){var t=Q.filter((function(t){return!e[t]}));return!!t.length&&(Y.error("You must define ".concat(function(e){if(!e.length)return"";if(1===e.length)return"".concat(e[0]);var t=e.length-1,n=e.slice(0,t).join(", ");return"".concat(n," and ").concat(e[t])}(t))),!0)}const ee={sessionWindow:30*s,sessionTimerWindow:60*u,requestValidityWindow:28*l,set:function(e){$(e)||(!function(e){if(P(e)&&Object.prototype.hasOwnProperty.call(e,"storeInfo")){var t=e.storeInfo;P(t)?("string"!=typeof t.storeName||t.storeName.length<=0)&&Y.error("storeName must be a non-empty string"):Y.error("storeInfo must be an object")}}(e),z=X.filter((function(t){return!!e[t]})).map((function(t){return[t,e[t]]})).reduce((function(e,t){return R(e,t)}),{}),J=Z.filter((function(t){return!!e[t]})).map((function(t){return[t,e[t]]})).reduce(R,{}))},getBaseParams:function(){return z?a({},z):{}},getCustomConfig:function(){return J?a({},J):{}},isInitialised:function(){return Q.reduce((function(e,t){return e&&!!z&&!!z[t]}),!0)},hasMissing:$,destroy:function(){z=null,J=null}};var te=function(e){return e.Queue="queue",e.ActivityState="activityState",e.GlobalParams="globalParams",e.EventDeduplication="eventDeduplication",e}(te||{}),ne=function(e){return e.Queue="q",e.ActivityState="as",e.GlobalParams="gp",e.EventDeduplication="ed",e}(ne||{}),re=function(e){return e.Preferences="p",e}(re||{}),oe={fields:{thirdPartySharingDisabled:{key:"td",keys:{reason:{key:"r",values:o({},d.REASON_GENERAL,1)},pending:{key:"p",values:{false:0,true:1}}}},sdkDisabled:{key:"sd",keys:{reason:{key:"r",values:o(o({},d.REASON_GENERAL,1),d.REASON_GDPR,2)},pending:{key:"p",values:{false:0,true:1}}}}}};function ie(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"values")}function ae(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"keys")}function ue(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"composite")}function se(e){return!!e&&"string"!=typeof e}const ce={queue:{name:ne.Queue,scheme:{keyPath:"timestamp",autoIncrement:!1,fields:{url:{key:"u",values:{"/session":1,"/event":2,"/gdpr_forget_device":3,"/sdk_click":4,"/disable_third_party_sharing":5}},method:{key:"m",values:{GET:1,POST:2,PUT:3,DELETE:4}},timestamp:"t",createdAt:"ca",params:{key:"p",keys:{timeSpent:"ts",sessionLength:"sl",sessionCount:"sc",eventCount:"ec",lastInterval:"li",eventToken:"et",revenue:"re",currency:"cu",callbackParams:"cp",partnerParams:"pp"}}}}},activityState:{name:ne.ActivityState,scheme:{keyPath:"uuid",autoIncrement:!1,fields:{uuid:{key:"u",values:{unknown:"-"}},timeSpent:"ts",sessionLength:"sl",sessionCount:"sc",eventCount:"ec",lastActive:"la",lastInterval:"li",installed:{key:"in",values:{false:0,true:1}},attribution:{key:"at",keys:{adid:"a",tracker_token:"tt",tracker_name:"tn",network:"nt",campaign:"cm",adgroup:"ag",creative:"cr",click_label:"cl",state:{key:"st",values:{installed:1,reattributed:2}}}}}}},globalParams:{name:ne.GlobalParams,scheme:{keyPath:"keyType",autoIncrement:!1,index:"type",fields:{keyType:{key:"kt",composite:["key","type"]},key:"k",value:"v",type:{key:"t",values:{callback:1,partner:2}}}}},eventDeduplication:{name:ne.EventDeduplication,scheme:{keyPath:"internalId",autoIncrement:!0,fields:{internalId:"ii",id:"i"}}},preferences:{name:re.Preferences,scheme:oe,permanent:!0}};function le(e){try{return JSON.parse(e)}catch(t){return e}}function de(e,t,n){var r,o=ie(n)?{values:(r=n.values,A(r).map((function(e){var t=S(e,2),n=t[0];return[t[1],le(n)]})).reduce(R,{}))}:{},i=ae(n)?{keys:fe(e,n.keys)}:{},u=ue(n)?{composite:n.composite.map((function(t){return me(e,t)}))}:{};return a(a(a({key:t},o),i),u)}function fe(e,t){return A(t).map((function(t){var n=S(t,2),r=n[0],o=n[1];return se(o)?[o.key,de(e,r,o)]:[o,r]})).reduce(R,{})}function me(e,t){if(t){var n=ce[e].scheme.fields[t];return se(n)?n.key:n||t}}var pe=A(ce).map((function(e){var t=S(e,2),n=t[0],r=t[1];return[n,{keyPath:r.scheme.keyPath,autoIncrement:r.scheme.autoIncrement,index:r.scheme.index,fields:r.scheme.fields}]})).reduce(R,{}),ve=A(pe).map((function(e){var t=S(e,2),n=t[0],r=t[1];return[n,{keyPath:me(n,r.keyPath),autoIncrement:r.autoIncrement,index:me(n,r.index),fields:fe(n,r.fields)}]})).reduce(R,{}),he=A(ce).reduce((function(e,t){var n=S(t,2)[1];return e.concat(n.scheme.fields)}),[]).map((function(e){return x(e).filter(ie).map((function(e){return A(e.values)})).reduce((function(e,t){return e.concat(t)}),[])})).reduce((function(e,t){return e.concat(t)}),[]).reduce(R,{}),ge=A(ce).map((function(e){var t=S(e,2),n=t[0],r=t[1];return[n,{name:r.name,permanent:r.permanent}]})).reduce(R,{});const ye={left:pe,right:ve,values:he,storeNames:{left:ge,right:(be=ge,A(be).map((function(e){var t=S(e,2),n=t[0],r=t[1],o={name:n,permanent:r.permanent};return[r.name,o]})).reduce(R,{}))}};var be,ke=function(e){return e.LowerBound="lowerBound",e.UpperBound="upperBound",e}(ke||{});function Se(e){return P(e)}var we=function(e){return e.right="right",e.left="left",e}(we||{});function Pe(e,t){return e&&void 0!==e[t]?e[t]:t}function De(e,t,n,r){if(n){var i=r||ye[t][Oe(e,we.right)].fields;return A(n).map((function(n){var r=S(n,2),o=r[0],a=r[1];return function(e,t,n,r,o){if(!o)return[n,r];var i=se(o)?o.key:o;return Se(r)?[i,De(e,t,r,ae(o)?o.keys:null)]:[i,Pe(ie(o)?o.values:null,r)]}(e,t,o,a,i[o])})).reduce((function(e,t){var n=S(t,2),r=n[0],i=n[1];return a(a({},e),{},o({},r,i))}),{})}}function Ne(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).map((function(n){return De(e,t,n)}))}function Ie(e,t,n){var r=ye[t][Oe(e,we.right)],o=r.fields[r.keyPath],i=n instanceof Array?n.slice():[n],a=(ue(o)?o.composite:[r.keyPath]).map((function(e,t){var n=r.fields[e];return Pe(ie(n)?n.values:null,i[t])}));return 1===a.length?a[0]:a}function Ee(e){return ye.values[e]||e}function Oe(e,t){return(ye.storeNames[t][e]||{}).name||e}function Re(e,t){return{name:t.name,message:t.message.replace('"'.concat(e,'"'),Oe(e,we.right))}}function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function Ce(e,t,n){return t&&xe(e.prototype,t),n&&xe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function je(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e+"",r=1;r<=t;r+=1)e<Math.pow(10,r)&&(n="0".concat(n));return n}function _e(e){var t=e?new Date(e):new Date,n=function(e){var t=je(e.getDate()),n=je(e.getMonth()+1);return[e.getFullYear(),n,t].join("-")}(t),r=function(e){var t=je(e.getHours(),1),n=je(e.getMinutes()),r=je(e.getSeconds()),o=je(e.getMilliseconds(),2);return[t,n,r].join(":")+"."+o}(t),o=function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+je(Math.floor(Math.abs(t)/60))+je(Math.abs(t)%60)}(t);return"".concat(n,"T").concat(r,"Z").concat(o)}function Te(e,t){return isNaN(e)||isNaN(t)?0:Math.abs(t-e)}var Be={},Ue=[];function Le(e,t){var n="id"+Math.random().toString(36).substring(2,16),r={id:n,cb:t};return Be[e]||(Be[e]=[]),Be[e].push(r),n}function Ke(e,t){Be[e]&&Be[e].forEach((function(n){"function"==typeof n.cb&&Ue.push(setTimeout((function(){return n.cb(e,t)})))}))}var qe={},Ge=!1,Me=!1;function Fe(){qe=Ge?a({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}):{}}function We(){Ge&&(qe.lastInterval=function(){var e=qe.lastActive;if(e)return Math.round(Te(e,Date.now())/u);return-1}(),qe.lastActive=Date.now())}function Ve(e){qe=a(a({},qe),e)}function He(){Me=!0}function Ye(){var e=qe.lastActive;return Math.round(Te(e,Date.now())/u)}function ze(){return(qe.timeSpent||0)+(Me?Ye():0)}function Je(){var e=Te(qe.lastActive,Date.now())<ee.sessionWindow,t=Me||!Me&&e;return(qe.sessionLength||0)+(t?Ye():0)}function Qe(){Ge&&(Ve({timeSpent:ze(),sessionLength:Je()}),We())}const Xe={get current(){return Ge?a({},qe):{}},set current(e){Fe(e)},init:function(e){Ge=!0,Fe(e)},isStarted:function(){return Ge},toForeground:He,toBackground:function(){Me=!1},initParams:function(){Qe(),He()},getParams:function(e){if(!Ge)return null;var t=qe.lastInterval>=0?qe.lastInterval:0,n={timeSpent:qe.timeSpent||0,sessionLength:qe.sessionLength||0,sessionCount:qe.sessionCount||1,lastInterval:t||0};return e&&O(e,"event")&&(n.eventCount=qe.eventCount),n},updateParams:function(e,t){if(Ge){var n={};n.timeSpent=ze(),n.sessionLength=Je(),O(e,"session")&&(n.sessionCount=(qe.sessionCount||0)+1),O(e,"event")&&(n.eventCount=(qe.eventCount||0)+1),Ve(n),t||We()}},updateInstalled:function(){Ge&&(qe.installed||Ve({installed:!0}))},updateSessionOffset:Qe,updateSessionLength:function(){Ge&&(Ve({sessionLength:Je()}),We())},resetSessionOffset:function(){Ge&&Ve({timeSpent:0,sessionLength:0})},updateLastActive:We,destroy:function(){qe={},Ge=!1,Me=!1},getAttribution:function(){return Ge?qe.attribution?qe.attribution:(Y.log("No attribution data yet"),null):null},getWebUUID:function(){return Ge?qe.uuid:null},waitForAttribution:function(){return qe.attribution?Promise.resolve(qe.attribution):new Promise((function(e){return Le(y.ATTRIBUTION_RECEIVED,(function(t,n){return e(n)}))}))},waitForWebUUID:function(){return qe.uuid?Promise.resolve(qe.uuid):new Promise((function(e){return Le(y.WEB_UUID_CREATED,(function(t,n){return e(n)}))}))}};var Ze=function(){return Ce((function e(){Ae(this,e),o(this,"items",{})}),[{key:"getItem",value:function(e){return Object.prototype.hasOwnProperty.call(this.items,e)?this.items[e]:null}},{key:"removeItem",value:function(e){delete this.items[e]}},{key:"setItem",value:function(e,t){this.items[e]=t}}])}();const $e=new(function(){return Ce((function e(){var t=this;Ae(this,e),o(this,"defaultName",_.namespace),o(this,"storageName",this.defaultName),o(this,"storeNames",ye.storeNames.left),this.storesMap={},j()?this.storage=window.localStorage:this.storage=new Ze;var n=this.read.bind(this),r=this.write.bind(this);x(this.storeNames).forEach((function(e){var o=e.name;Object.defineProperty(t.storesMap,o,{get:function(){return n(o)},set:function(e){r(o,e)}})})),Object.freeze(this.storesMap)}),[{key:"read",value:function(e){var t=this.storage.getItem("".concat(this.storageName,".").concat(e)),n=t?JSON.parse(t):null;return e===re.Preferences&&n?De(re.Preferences,we.right,n):n}},{key:"write",value:function(e,t){t?this.storage.setItem("".concat(this.storageName,".").concat(e),JSON.stringify(t instanceof Array?t:De(re.Preferences,we.left,t))):this.storage.removeItem("".concat(this.storageName,".").concat(e))}},{key:"clear",value:function(){this.deleteData()}},{key:"deleteData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];x(this.storeNames).forEach((function(n){!t&&n.permanent||e.storage.removeItem("".concat(e.storageName,".").concat(n.name))}))}},{key:"setCustomName",value:function(e){var t=this;if(e&&e.length){var n="".concat(_.namespace,"-").concat(e);x(this.storeNames).forEach((function(e){var r=e.name,o=t.storage.getItem("".concat(t.storageName,".").concat(r));o&&t.storage.setItem("".concat(n,".").concat(r),o)})),this.deleteData(!0),this.storageName=n}}},{key:"stores",get:function(){return this.storesMap}}])}());var et=ce.preferences.name,tt=null;function nt(){return tt||rt(),tt?a({},tt):null}function rt(){tt=$e.stores[et]}function ot(){var e=nt();return e&&e.sdkDisabled||null}function it(e){var t=e?a({},e):null;$e.stores[et]=a(a({},nt()),{},{sdkDisabled:t}),rt()}function at(){var e=$e.stores[et]||{},t=(tt||{}).sdkDisabled||null;e.sdkDisabled&&!t&&Ke("sdk:shutdown"),rt()}function ut(){$e.stores[et]||($e.stores[et]=a({},tt))}tt=nt();var st=function(e){return e.add="add",e.put="put",e.get="get",e.list="list",e.clear="clear",e.delete="delete",e}(st||{}),ct=function(e){return e.readonly="readonly",e.readwrite="readwrite",e}(ct||{}),lt=function(){function e(){Ae(this,e),o(this,"dbDefaultName",_.namespace),o(this,"dbName",this.dbDefaultName),o(this,"dbVersion",1),o(this,"indexedDbConnection",null),o(this,"notSupportedError",{name:"IDBNotSupported",message:"IndexedDB is not supported"}),o(this,"databaseOpenError",{name:"CannotOpenDatabaseError",message:"Cannot open a database"}),o(this,"noConnectionError",{name:"NoDatabaseConnection",message:"Cannot open a transaction"});var t=e.getIndexedDB();if(!t)throw this.notSupportedError;this.idbFactory=t}return Ce(e,[{key:"setCustomName",value:function(e){return e&&e.length>0?(this.dbName="".concat(_.namespace,"-").concat(e),this.migrateDb(this.dbDefaultName,this.dbName)):Promise.resolve()}},{key:"openDatabase",value:function(t,n,r){var o=this;return e.isSupported().then((function(e){return e?new Promise((function(e,i){var a=o.idbFactory.open(t,r);n&&(a.onupgradeneeded=function(e){return n(e,i)}),a.onsuccess=function(t){var n=t.target.result;n?e(n):i(o.databaseOpenError)},a.onerror=i})):Promise.reject(o.notSupportedError)}))}},{key:"databaseExists",value:function(e){var t=this;return new Promise((function(n){var r=!0;t.openDatabase(e,(function(){r=!1})).then((function(n){if(n.close(),!r)return t.deleteDatabaseByName(e)})).then((function(){return n(r)}))}))}},{key:"cloneData",value:function(e,t){var n=this;return x(ye.storeNames.left).map((function(e){return e.name})).filter((function(e){return"p"!==e})).map((function(r){return function(){return o=r,i=n.indexedDbConnection,n.indexedDbConnection=e,n.getAll(o).then((function(e){if(n.indexedDbConnection=t,!(e.length<1))return n.addBulk(o,e,!0)})).then((function(){n.indexedDbConnection=i}));var o,i}})).reduce((function(e,t){return e.then(t)}),Promise.resolve())}},{key:"migrateDb",value:function(e,t){var n=this;return this.databaseExists(e).then((function(r){return r?Promise.all([n.openDatabase(e,n.handleUpgradeNeeded,n.dbVersion),n.openDatabase(t,n.handleUpgradeNeeded,n.dbVersion)]).then((function(t){var r=S(t,2),o=r[0],i=r[1];return n.cloneData(o,i).then((function(){return n.indexedDbConnection=i,o.close(),n.deleteDatabaseByName(e)}))})).then((function(){return Y.info("Database migration finished")})):n.openDatabase(t,n.handleUpgradeNeeded,n.dbVersion).then((function(e){n.indexedDbConnection=e}))}))}},{key:"handleUpgradeNeeded",value:function(e,t){var n=e.target.result;e.target.transaction.onerror=t,e.target.transaction.onabort=t;var r=ye.storeNames.left,o=Xe.current||{},i=o&&!w(o);A(r).filter((function(e){return!S(e,2)[1].permanent})).forEach((function(e){var t=S(e,2),r=t[0],a=t[1].name,u=ye.right[r],s=n.createObjectStore(a,{keyPath:u.keyPath,autoIncrement:u.autoIncrement||!1});if(u.index&&s.createIndex("".concat(u.index,"Index"),u.index),a===ne.ActivityState&&i)return s.add(De(r,we.left,o)),void Y.info("Activity state has been recovered");var c=$e.stores[a];c&&(c.forEach((function(e){return s.add(e)})),Y.info("Migration from localStorage done for ".concat(r," store")))})),ut(),$e.clear()}},{key:"open",value:function(){var e=this;return this.indexedDbConnection?Promise.resolve({success:!0}):this.openDatabase(this.dbName,this.handleUpgradeNeeded,this.dbVersion).then((function(t){return e.indexedDbConnection=t,e.indexedDbConnection.onclose=function(){return e.destroy},{success:!0}}))}},{key:"getTransactionStore",value:function(e,t,n){var r,o=e.storeName,i=e.mode,a=n.transaction([o],i),u=a.objectStore(o),s=ye.right[Oe(o,we.right)];return s.index&&(r=u.index("".concat(s.index,"Index"))),a.onerror=t,a.onabort=t,{transaction:a,store:u,index:r,options:s}}},{key:"overrideError",value:function(e,t){var n=t.target.error;return e({name:n.name,message:n.message})}},{key:"getCompositeKeys",value:function(e){var t=e.fields[e.keyPath];return ue(t)?t.composite:null}},{key:"targetIsObject",value:function(e){return P(e)}},{key:"prepareTarget",value:function(e,t,n){if(n===st.clear||!t)return null;var r=this.getCompositeKeys(e);return-1!==[st.add,st.put].indexOf(n)?this.targetIsObject(t)?r?a(o({},e.keyPath,r.map((function(e){return t[e]})).join("")),t):t:null:t instanceof Array?t.join(""):t}},{key:"prepareResult",value:function(e,t){var n=this.getCompositeKeys(e);return n&&this.targetIsObject(t)?n.map((function(e){return t[e]})):null}},{key:"initRequest",value:function(e){var t=this,n=e.storeName,r=e.target,o=void 0===r?null:r,i=e.action,a=e.mode,u=void 0===a?ct.readonly:a;return this.open().then((function(){return new Promise((function(e,r){if(t.indexedDbConnection){var a=t.getTransactionStore({storeName:n,mode:u},r,t.indexedDbConnection),s=a.store,c=a.options,l=s[i](t.prepareTarget(c,o,i)),d=t.prepareResult(c,o);l.onsuccess=function(){i!==st.get||l.result?e(d||l.result||o):r({name:"NotRecordFoundError",message:'Requested record not found in "'.concat(n,'" store')})},l.onerror=function(e){return t.overrideError(r,e)}}else r(t.noConnectionError)}))}))}},{key:"initBulkRequest",value:function(e){var t=this,n=e.storeName,r=e.target,o=e.action,i=e.mode,a=void 0===i?ct.readwrite:i;return!r||r&&!r.length?Promise.reject({name:"NoTargetDefined",message:"No array provided to perform ".concat(o,' bulk operation into "').concat(n,'" store')}):this.open().then((function(){return new Promise((function(e,i){if(t.indexedDbConnection){var u=t.getTransactionStore({storeName:n,mode:a},i,t.indexedDbConnection),s=u.transaction,c=u.store,l=u.options,d=new Array,f=r[0];s.oncomplete=function(){return e(d)};!function e(n){n.onerror=function(e){return t.overrideError(i,e)},n.onsuccess=function(){d.push(t.prepareResult(l,f)||n.result),f=r[d.length],d.length<r.length&&e(c[o](t.prepareTarget(l,f,o)))}}(c[o](t.prepareTarget(l,f,o)))}else i(t.noConnectionError)}))}))}},{key:"openCursor",value:function(e){var t=this,n=e.storeName,r=e.action,o=e.range,i=void 0===o?null:o,a=e.firstOnly,u=void 0!==a&&a,s=e.mode,c=void 0===s?ct.readonly:s;return this.open().then((function(){return new Promise((function(e,o){if(t.indexedDbConnection){var a=t.getTransactionStore({storeName:n,mode:c},o,t.indexedDbConnection),s=a.transaction,l=a.store,d=a.index,f=a.options,m=(d||l).openCursor(i),p=new Array;s.oncomplete=function(){return e(p)},m.onsuccess=function(e){var n=e.target.result;n&&(r===st.delete?(n.delete(),p.push(t.prepareResult(f,n.value)||n.value[f.keyPath])):p.push(n.value),u||n.continue())},m.onerror=function(e){return t.overrideError(o,e)}}else o(t.noConnectionError)}))}))}},{key:"deleteDatabaseByName",value:function(e){var t=this;return new Promise((function(n,r){var o=t.idbFactory.deleteDatabase(e);o.onerror=function(e){return t.overrideError(r,e)},o.onsuccess=function(){return n()},o.onblocked=function(e){return r(e.target)}}))}},{key:"getAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.openCursor({storeName:e,action:st.list,firstOnly:t})}},{key:"getFirst",value:function(e){return this.getAll(e,!0).then((function(e){return e.length?e[0]:void 0}))}},{key:"getItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:st.get})}},{key:"filterBy",value:function(e,t){var n=IDBKeyRange.only(t);return this.openCursor({storeName:e,action:st.list,range:n})}},{key:"addItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:st.add,mode:ct.readwrite})}},{key:"addBulk",value:function(e,t,n){return this.initBulkRequest({storeName:e,target:t,action:n?st.put:st.add,mode:ct.readwrite})}},{key:"updateItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:st.put,mode:ct.readwrite})}},{key:"deleteItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:st.delete,mode:ct.readwrite})}},{key:"deleteBulk",value:function(e,t,n){var r=n?IDBKeyRange[n](t):IDBKeyRange.only(t);return this.openCursor({storeName:e,action:st.delete,range:r,mode:ct.readwrite})}},{key:"trimItems",value:function(e,t){var n=this,r=ye.right[Oe(e,we.right)];return this.getAll(e).then((function(e){return e.length?e[t-1]:null})).then((function(t){return t?n.deleteBulk(e,t[r.keyPath],ke.UpperBound):[]}))}},{key:"count",value:function(e){var t=this;return this.open().then((function(){return new Promise((function(n,r){if(t.indexedDbConnection){var o=t.getTransactionStore({storeName:e,mode:ct.readonly},r,t.indexedDbConnection).store.count();o.onsuccess=function(){return n(o.result)},o.onerror=function(e){return t.overrideError(r,e)}}else r(t.noConnectionError)}))}))}},{key:"clear",value:function(e){return this.initRequest({storeName:e,action:st.clear,mode:ct.readwrite})}},{key:"destroy",value:function(){this.indexedDbConnection&&this.indexedDbConnection.close(),this.indexedDbConnection=null}},{key:"deleteDatabase",value:function(){return this.destroy(),this.deleteDatabaseByName(this.dbName)}}],[{key:"tryOpen",value:function(t){return new Promise((function(n){try{var r=t.open(e.dbValidationName);r.onsuccess=function(){r.result.close(),t.deleteDatabase(e.dbValidationName),n(!0)},r.onerror=function(){return n(!1)}}catch(e){n(!1)}}))}},{key:"isSupported",value:function(){if(e.isSupportedPromise)return e.isSupportedPromise;var t="IndexedDB is not supported in this browser";return e.isSupportedPromise=new Promise((function(n){var r=e.getIndexedDB(),o=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!r||o?(Y.warn(t),n(!1)):n(e.tryOpen(r).then((function(e){return e||Y.warn(t),e})))})),e.isSupportedPromise}},{key:"getIndexedDB",value:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB}}])}();function dt(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}o(lt,"dbValidationName","validate-db-openable"),o(lt,"isSupportedPromise",null);var ft=function(){function e(){Ae(this,e)}return Ce(e,[{key:"open",value:function(){return e.isSupported().then((function(e){if(!e)return{status:"error",error:{name:"LSNotSupported",message:"LocalStorage is not supported"}};var t=ye.storeNames.left,n=Xe.current||{},r=n&&!w(n);return A(t).filter((function(e){return!S(e,2)[1].permanent})).forEach((function(e){var t=S(e,2),o=t[0],i=t[1].name;i!==ne.ActivityState||$e.stores[i]?$e.stores[i]||($e.stores[i]=[]):$e.stores[i]=r?[De(o,we.left,n)]:[]})),ut(),{status:"success"}}))}},{key:"getCompositeKeys",value:function(e){var t=e.fields[e.keyPath];return ue(t)?t.composite:null}},{key:"getKeys",value:function(e){var t=Oe(e,we.right),n=ye.right[t];return this.getCompositeKeys(n)||[n.keyPath]}},{key:"nextIndex",value:function(e){return"number"==typeof e?e+1:void 0}},{key:"initRequest",value:function(e,t){var n=this,r=e.storeName,o=e.id,i=e.item,u=ye.right[Oe(r,we.right)];return this.open().then((function(e){return"error"===e.status?Promise.reject(e.error):new Promise((function(e,s){var c,l=$e.stores[r],d=n.getKeys(r),f=(l[l.length-1]||{})[u.keyPath]||0;if(o){var m=Array.isArray(o)?o.slice():[o];c=d.map((function(e,t){return[e,m[t]]})).reduce(R,{})}else c=a({},i);var p=c?N(l,d,c):0;return t(e,s,{keys:d,items:l,index:p,options:u,lastId:f})}))}))}},{key:"sort",value:function(e,t,n){var r=dt(e),o=t.slice().reverse();return r.sort((function(e,t){return o.reduce((function(r,o){return r||function(e,t,r){var o=n?n===e[r]:e[r]<t[r],i=n?n>e[r]:e[r]>t[r];return o?-1:i?1:0}(e,t,o)}),0)}))}},{key:"prepareTarget",value:function(e,t,n){var r=this.getCompositeKeys(e);return r?a(o({},e.keyPath,r.map((function(e){return t[e]})).join("")),t):e.autoIncrement&&n?a(o({},e.keyPath,n),t):a({},t)}},{key:"prepareResult",value:function(e,t){var n=this.getCompositeKeys(e);return n?n.map((function(e){return t[e]})).filter((function(e){return!Se(e)})):t[e.keyPath]}},{key:"getAll",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.open().then((function(r){return"error"===r.status?Promise.reject(r.error):new Promise((function(r,o){var i=$e.stores[e];i instanceof Array?r(n?[i[0]]:t.sort(i,t.getKeys(e))):o({name:"NotFoundError",message:"No objectStore named ".concat(e," in this database")})}))}))}},{key:"getFirst",value:function(e){return this.getAll(e,!0).then((function(e){return e.length?e[0]:void 0}))}},{key:"getItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,id:t},(function(t,r,o){var i=o.items,a=o.index,u=o.options;-1===a?r({name:"NotRecordFoundError",message:'Requested record not found in "'.concat(e,'" store')}):t(n.prepareTarget(u,i[a]))}))}},{key:"filterBy",value:function(e,t){return this.getAll(e).then((function(n){return n.filter((function(n){var r=ye.right[Oe(e,we.right)];return(r.index&&n[r.index])===t}))}))}},{key:"addItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,item:t},(function(r,o,i){var a=i.items,u=i.index,s=i.options,c=i.lastId;-1!==u?o({name:"ConstraintError",message:'Constraint was not satisfied, trying to add existing item into "'.concat(e,'" store')}):(a.push(n.prepareTarget(s,t,n.nextIndex(c))),$e.stores[e]=a,r(n.prepareResult(s,t)))}))}},{key:"addBulk",value:function(e,t,n){var r=this;return this.initRequest({storeName:e},(function(o,i,a){var u=a.keys,s=a.items,c=a.options,l=a.lastId;if(!t||t&&!t.length)i({name:"NoTargetDefined",message:'No array provided to perform add bulk operation into "'.concat(e,'" store')});else{var d=l,f=t.map((function(e){return r.prepareTarget(c,e,d=r.nextIndex(d))})),m=f.filter((function(e){return-1!==N(s,u,e)})).map((function(e){return e[c.keyPath]})),p=n?s.filter((function(e){return-1===m.indexOf(e[c.keyPath])})):dt(s);if(m.length&&!n)i({name:"ConstraintError",message:'Constraint was not satisfied, trying to add existing items into "'.concat(e,'" store')});else $e.stores[e]=r.sort([].concat(dt(p),dt(f)),u),o(t.map((function(e){return r.prepareResult(c,e)})))}}))}},{key:"updateItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,item:t},(function(r,o,i){var a=i.items,u=i.index,s=i.options,c=i.lastId,l=-1===u?n.nextIndex(c):void 0,d=n.prepareTarget(s,t,l);-1===u?a.push(d):a.splice(u,1,d),$e.stores[e]=a,r(n.prepareResult(s,t))}))}},{key:"deleteItem",value:function(e,t){return this.initRequest({storeName:e,id:t},(function(n,r,o){var i=o.items,a=o.index;-1!==a&&(i.splice(a,1),$e.stores[e]=i),n(t)}))}},{key:"findMax",value:function(e,t,n){if(!e.length)return-1;for(var r={index:-1,value:"string"==typeof n?"":0},o=0;o<e.length;o+=1){if(!(e[o][t]<=n))return r.index;e[o][t]>=r.value&&(r={value:e[o][t],index:o})}return r.index}},{key:"deleteBulk",value:function(e,t,n){var r=this;return this.getAll(e).then((function(o){var i=r.getKeys(e),a=ye.right[Oe(e,we.right)].index||i[0],u=n?null:t,s=r.sort(o,i,u),c=r.findMax(s,a,t);if(-1===c)return[];var l=n===ke.LowerBound?c:0,d=n&&n!==ke.UpperBound?s.length:c+1,f=s.splice(l,d).map((function(e){return 1===i.length?e[a]:i.map((function(t){return e[t]}))}));return $e.stores[e]=s,f}))}},{key:"trimItems",value:function(e,t){var n=this,r=Oe(e,we.right),o=ye.right[r];return this.getAll(e).then((function(e){return e.length?e[t-1]:null})).then((function(t){return t?n.deleteBulk(e,t[o.keyPath],ke.UpperBound):[]}))}},{key:"count",value:function(e){return this.open().then((function(t){if("error"===t.status)return Promise.reject(t.error);var n=$e.stores[e];return Promise.resolve(n instanceof Array?n.length:1)}))}},{key:"clear",value:function(e){return this.open().then((function(t){return"error"===t.status?Promise.reject(t.error):new Promise((function(t){$e.stores[e]=[],t()}))}))}},{key:"destroy",value:function(){}},{key:"deleteDatabase",value:function(){}}],[{key:"isSupported",value:function(){return e.isSupportedPromise||(e.isSupportedPromise=new Promise((function(e){var t=j();t||Y.warn("LocalStorage is not supported in this browser"),e(t)}))),e.isSupportedPromise}}])}();o(ft,"isSupportedPromise",null);var mt,pt=function(e){return e[e.noStorage=m.NO_STORAGE]="noStorage",e[e.indexedDB=m.INDEXED_DB]="indexedDB",e[e.localStorage=m.LOCAL_STORAGE]="localStorage",e}(pt||{}),vt={getAll:function(e,t,n){return e.getAll(t,n).then((function(e){return Ne(t,we.right,e)}))},getFirst:function(e,t){return e.getFirst(t).then((function(e){return De(t,we.right,e)}))},getItem:function(e,t,n){return e.getItem(t,Ie(t,we.left,n)).then((function(e){return De(t,we.right,e)})).catch((function(e){return Promise.reject(Re(t,e))}))},filterBy:function(e,t,n){return e.filterBy(t,Ee(n)).then((function(e){return Ne(t,we.right,e)}))},addItem:function(e,t,n){var r=De(t,we.left,n);return e.addItem(t,r).then((function(e){return Ie(t,we.right,e)})).catch((function(e){return Promise.reject(Re(t,e))}))},addBulk:function(e,t,n,r){var o=Ne(t,we.left,n);return e.addBulk(t,o,r).then((function(e){return e.map((function(e){return Ie(t,we.right,e)}))})).catch((function(e){return Promise.reject(Re(t,e))}))},updateItem:function(e,t,n){var r=De(t,we.left,n);return e.updateItem(t,r).then((function(e){return Ie(t,we.right,e)}))},deleteItem:function(e,t,n){return e.deleteItem(t,Ie(t,we.left,n)).then((function(e){return Ie(t,we.right,e)}))},deleteBulk:function(e,t,n,r){return e.deleteBulk(t,Ee(n),r).then((function(e){return e.map((function(e){return Ie(t,we.right,e)}))}))},trimItems:function(e,t,n){return e.trimItems(t,n)},count:function(e,t){return e.count(t)},clear:function(e,t){return e.clear(t)},destroy:function(e){return e.destroy()},deleteDatabase:function(e){return e.deleteDatabase()}};var ht=null;function gt(e){var t=null;return null!==ht?ht:ht=Promise.all([lt.isSupported(),ft.isSupported()]).then((function(n){var r=S(n,2),o=r[0],i=r[1];if($e.setCustomName(e),o){mt=pt.indexedDB;var a=new lt;return a.setCustomName(e).then((function(){return t=a}))}return i?(mt=pt.localStorage,t=new ft,Promise.resolve(t)):(Y.error("There is no storage available, app will run with minimum set of features"),mt=pt.noStorage,t=null,Promise.resolve(t))})).then((function(){return{type:mt,storage:t}}))}const yt=a({init:gt,getType:function(){return mt}},(bt=A(vt).map((function(e){var t=S(e,2),n=t[0],r=t[1];return[n,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return gt().then((function(t){var o=t.storage;if(o)return r.call.apply(r,[null,o,Oe(e,we.left)].concat(n))}))}]})),bt.reduce(R,{})));var bt;function kt(){return yt.getAll("queue").then((function(e){return{queueSize:e.length}})).then((function(e){return a(a(a(a(a(a(a(a({},{createdAt:_e()}),{sentAt:_e()}),{webUuid:Xe.current.uuid}),(n=navigator,r=void 0!==n.doNotTrack,o=void 0!==window.doNotTrack,i=void 0!==n.msDoNotTrack,u=r?n.doNotTrack:o?window.doNotTrack:i?n.msDoNotTrack:null,0===parseInt(u,10)||"no"===u?{trackingEnabled:!0}:1===parseInt(u,10)||"yes"===u?{trackingEnabled:!1}:null)),{platform:"web"}),function(){var e=navigator,t=S((e.language||e.userLanguage||"en").split("-"),2),n=t[0],r=t[1];return{language:n,country:r?""+r.toLowerCase():void 0}}()),(t=navigator.userAgent||navigator.vendor,{machineType:"Win32"!==navigator.platform||-1===t.indexOf("WOW64")&&-1===t.indexOf("Win64")?navigator.platform:"Win64"})),e);var t,n,r,o,i,u}))}function St(e,t){return{status:"error",action:arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"CONTINUE":"RETRY",response:D(e.responseText)?JSON.parse(e.responseText):e.responseText,message:f[t],code:t}}function wt(e,t){var n=e.length-t.length-1,r=e.slice(0,n>0?n:0).split("").reduce((function(e){return e.concat(" ")}),"");return"".concat(t).concat(r,":")}function Pt(e,t){var n="REQUEST PARAMETERS:",r=function(e){return e.replace(/([A-Z])/g,(function(e){return"_".concat(e.toLowerCase())}))},o=[];return A(a(a(a({},ee.getBaseParams()),t),e)).forEach((function(e){var t=S(e,2),n=t[0],i=t[1];"storeInfo"===n?P(i)&&(o.push(["store_name_from_client",i.storeName]),o.push(["store_app_id_from_client",i.storeAppId])):o.push([r(n),i])})),Y.log(n),o.filter((function(e){return C(S(e,2)[1])})).map((function(e){var t=S(e,2),r=t[0],o=t[1];return Y.log(wt(n,r),o),function(e){var t=S(e,2),n=t[0],r=t[1],o=encodeURIComponent(n),i=r;return"string"==typeof r&&(i=encodeURIComponent(r)),P(r)&&(i=encodeURIComponent(JSON.stringify(r)||"")),[o,i].join("granular_third_party_sharing_options"===n||"partner_sharing_settings"===n?encodeURIComponent("="):"=")}([r,o])})).join("&")}function Dt(e,t,n){var r=n.xhr,o=n.url;if(4===r.readyState){var i=r.status>=200&&r.status<300,a=D(r.responseText);if(0!==r.status)return a?t(i?function(e,t){var n=JSON.parse(e.responseText),r={status:"success",adid:n.adid,timestamp:n.timestamp,ask_in:n.ask_in,retry_in:n.retry_in,continue_in:n.continue_in,tracking_state:n.tracking_state,attribution:void 0,message:void 0};return O(t,"attribution")&&(r.attribution=n.attribution,r.message=n.message),A(r).filter((function(e){return!!S(e,2)[1]})).reduce(R,{})}(r,o):St(r,"SERVER_CANNOT_PROCESS",!0)):e(St(r,i?"SERVER_MALFORMED_RESPONSE":"SERVER_INTERNAL_ERROR"));e(St(r,"NO_CONNECTION"))}}function Nt(e,t){var n=e.endpoint,r=e.url,o=e.method,i=void 0===o?"GET":o,a=e.params,u=function(e,t){var n=e.endpoint,r=e.url,o=e.method,i=Pt(e.params,t);return{fullUrl:n+r+("GET"===o?"?".concat(i):""),encodedParams:i}}({endpoint:n,url:r,method:i,params:void 0===a?{}:a},t),s=u.fullUrl,c=u.encodedParams;return new Promise((function(e,t){var n=new XMLHttpRequest;n.open(i,s,!0),function(e,t){var n="REQUEST HEADERS:",r=[["Client-SDK","js".concat(_.version)],["Content-Type","POST"===t?"application/x-www-form-urlencoded":"application/json"]];Y.log(n),r.forEach((function(t){var r=S(t,2),o=r[0],i=r[1];e.setRequestHeader(o,i),Y.log(wt(n,o),i)}))}(n,i),n.onreadystatechange=function(){return Dt(t,e,{xhr:n,url:r})},n.onerror=function(){return t(St(n,"TRANSACTION_ERROR"))},n.send("GET"===i?void 0:c)}))}function It(e,t){return"success"===e.status?function(e,t){var n=O(t,"gdpr_forget_device"),r=O(t,"attribution"),o=O(t,"session"),i="opted_out"===e.tracking_state;if(!n&&i)return Ke("sdk:gdpr-forget-me"),e;r||n||i||!e.ask_in||Ke("attribution:check",e);o&&Ke("session:finished",e);return e}(e,t):e}var Et={long:{delay:2*s,maxDelay:l,minRange:.5,maxRange:1},short:{delay:200,maxDelay:c,minRange:.5,maxRange:1},test:{delay:100,maxDelay:300}};function Ot(e,t){var n,r,o=Et[t=t||"long"],i=o.delay*Math.pow(2,e-1);return i=Math.min(i,o.maxDelay),o.minRange&&o.maxRange&&(i*=(n=o.minRange,r=o.maxRange,Math.random()*(r-n)+n)),Math.round(i)}var Rt=navigator.onLine;function At(){Rt=!0}function xt(){Rt=!1}function Ct(e,t,n){e.addEventListener&&e.addEventListener(t,n,!1)}function jt(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}function _t(e){return{domains:[e.default,e.world],useSubdomains:!0,isDataResidency:!1}}var Tt=function(e){return e.Default="default",e.India="india",e.China="china",e}(Tt||{});function Bt(e,t){Y.warn("Both ".concat(e," and ").concat(t," are set in config, ").concat(t," will be ignored"))}function Ut(e){return function(e){var t=ee.getCustomConfig(),n=t.customUrl,r=t.urlStrategy,o=t.dataResidency;if(n)return Y.warn("customUrl is deprecated, use urlStrategy instead"),(o||r)&&Bt("customUrl",o?"dataResidency":"urlStrategy"),{domains:[n],useSubdomains:!1,isDataResidency:!1};if(o&&r&&Bt("dataResidency","urlStrategy"),o)return Y.warn("dataResidency is deprecated, use urlStrategy instead"),{domains:[e[o]],useSubdomains:!0,isDataResidency:!0};if("string"==typeof r){if(Y.warn("urlStrategy string literals ('china' and 'india') are deprected, use UrlStartegyConfig instead"),r===Tt.India)return{domains:[e.india,e.default],useSubdomains:!0,isDataResidency:!1};if(r===Tt.China)return{domains:[e.china,e.default],useSubdomains:!0,isDataResidency:!1}}return r?null:_t(e)}(e)||function(e){var t=ee.getCustomConfig().urlStrategy;if(t&&"object"===n(t)){var r=t;return!r.domains||!Array.isArray(r.domains)||r.domains.length<1?(Y.warn("Invalid urlStartegy: `domains` should be a non-empty array"),_t(e)):{domains:r.domains,useSubdomains:!!r.useSubdomains,isDataResidency:!!r.isDataResidency}}return _t(e)}(e)}function Lt(e){var t,n=Ut(e),r=[],o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=k(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(n.domains);try{for(o.s();!(t=o.n()).done;){var i=t.value,a=n.useSubdomains?{app:"".concat(v).concat(i),gdpr:"".concat(h).concat(i)}:{app:"".concat(g).concat(i),gdpr:"".concat(g).concat(i)};r.push(a)}}catch(e){o.e(e)}finally{o.f()}return r}var Kt=150,qt=2147483647,Gt=60*u;const Mt=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.url,o=n.method,i=void 0===o?"GET":o,u=n.params,s=void 0===u?{}:u,c=n.continueCb,l=n.strategy,d=n.wait,m={url:r,method:i,params:s,continueCb:c},v=r,h=i,g=a({},s),y=c,b=l,k=function(){e.reset(),t=e.next()},P=function(e,t){return e["/gdpr_forget_device"===t?"gdpr":"app"]},D=null,N={request:0,connection:0},I=O(d),E=null;function O(e){return(e=e||Kt)>qt?qt:e}function x(n){var r=n.wait,o=n.retrying;return e||(e=function(){var e=Lt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:p),t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{value:void 0,done:!0}},reset:function(){t=0}}}(),t=e.next()),I=r?O(r):I,function(e){if(!E)return!1;if(D){var t=I-(Date.now()-E);if(e&&t<e)return!0;L()}return!1}(r)?Promise.resolve({status:"error",action:"CONTINUE",response:"",message:f.SKIP,code:"SKIP"}):v?(Y.log("".concat(o?"Re-trying":"Trying"," request ").concat(v," in ").concat(I,"ms")),E=Date.now(),j({endpoint:P(t.value,v),url:v,method:h,params:a({attempts:1},g)})):(Y.error("You must define url for the request to be sent"),Promise.reject({status:"error",action:"CONTINUE",response:"",message:f.MISSING_URL,code:"MISSING_URL"}))}function j(n){return U(),Rt?function(n){return new Promise((function(r,o){D=setTimeout((function(){E=null;var i=A(n.params).filter((function(e){return C(S(e,2)[1])})).reduce(R,{});return function(e){return kt().then((function(t){return Nt(e,t)})).then((function(t){return It(t,e.url)}))}({endpoint:n.endpoint,url:n.url,method:n.method,params:a(a({},i),{},{attempts:(N.request?N.request+1:1)+N.connection})}).then((function(e){return function(e,t){if(e&&e.retry_in)return void t(B(e.retry_in));k(),"function"==typeof y?y(e,T,B):T();t(e)}(e,r)})).catch((function(n){return function(n,r,o){if(n&&"RETRY"===n.action){if("NO_CONNECTION"===n.code){var i=e.next();i.done?(k(),r(B(Gt))):(t=i,r(B(Kt)))}else r(B());return}T(!0),o(n||{})}(n,r,o)}))}),I)}))}(n):(N.connection+=1,Y.log("No internet connectivity, trying request ".concat(n.url," in ").concat(Gt,"ms")),new Promise((function(e){D=setTimeout((function(){e(j(n))}),Gt)})))}function _(){v=m.url,h=m.method,g=a({},m.params),y=m.continueCb}function T(e){Y.log("Request ".concat(v||"unknown"," ").concat(e?"failed":"has been finished")),N.request=0,N.connection=0,I=Kt,_(),L()}function B(e){return N.request+=1,L(),x({wait:e||Ot(N.request,b),retrying:!0})}function U(){D&&clearTimeout(D),D=null}function L(){var e=!!E;U(),E=null,e&&(I=Kt,N.request=0,N.connection=0,Y.log("Previous ".concat(v||"unknown"," request attempt canceled")),_())}return{send:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.method,r=e.params,o=void 0===r?{}:r,i=e.continueCb,u=e.wait;return function(e){var t=e.url,n=e.method,r=e.params,o=e.continueCb;t&&(v=t),n&&(h=n),w(r)||(g=a({},r)),g=a({createdAt:_e()},g),"function"==typeof o&&(y=o)}({url:t,method:n,params:o,continueCb:i}),x({wait:u})},isRunning:function(){return!!D},clear:L}};var Ft=function(e){return e===d.REASON_GDPR?"GDPR disable":"disable"},Wt=function(e){return{start:{inProgress:"Adjust SDK ".concat(Ft(e)," process has already started"),done:"Adjust SDK ".concat(Ft(e)," process is now started")},finish:{inProgress:"Adjust SDK ".concat(Ft(e)," process has already finished"),done:"Adjust SDK ".concat(Ft(e)," process is now finished")}}};function Vt(e,t){var n=e.reason,r=e.pending,o=ot()||{},i=o.reason,a=o.pending,u="start"===t&&a?"start":"finish";return"start"===t&&i||"finish"===t&&i&&!a?(Y.log(Wt(i)[u].inProgress),!1):(Y.log(Wt(n)[u].done),it({reason:n||d.REASON_GENERAL,pending:r}),!0)}function Ht(e){return Vt({reason:e,pending:arguments.length>1&&void 0!==arguments[1]&&arguments[1]},"start")}function Yt(){var e=ot()||{},t=e.reason,n=e.pending;return t===d.REASON_GENERAL||t===d.REASON_GDPR&&!n?"off":t===d.REASON_GDPR&&n?"paused":"on"}var zt=te.ActivityState,Jt=!1;function Qt(e){return e?"unknown"===e.uuid?(Ht(d.REASON_GDPR),Xe.destroy(),{exists:!0,stored:null}):(Xe.init(e),{exists:!0,stored:e}):{exists:!1}}function Xt(){return"off"!==Yt()&&Xe.isStarted()}function Zt(){if(!Xt())return Promise.resolve(null);var e=a(a({},Xe.current),{},{lastActive:Date.now()});return yt.updateItem(zt,e).then((function(){return Xe.current=e}))}var $t=Mt({strategy:"long",continueCb:function(e,t){var n=e&&e.continue_in||null;return nn.pause=n?{timestamp:Date.now(),wait:n}:null,yt.getFirst(tn).then((function(e){return e?yt.deleteItem(tn,e.timestamp):null})).then((function(){var r,o="error"===e.status||(null===(r=e.response)||void 0===r?void 0:r.error);return t(o),nn.running=!1,un({wait:n})}))}}),en=!1,tn="queue",nn={running:!1,timestamp:null,pause:null};function rn(){var e=Date.now();return nn.timestamp&&e<=nn.timestamp&&(e=nn.timestamp+1),nn.timestamp=e,e}function on(e){var t=e.url,n=e.method,r=e.params,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.auto,u=o.timestamp;Xe.updateParams(t,i);var s=A(r||{}).filter((function(e){return C(S(e,2)[1])})).reduce(R,{}),c={timestamp:rn(),url:t,method:n,params:a(a({},Xe.getParams(t)),s)};return u&&(c.createdAt=u),yt.addItem(tn,c).then((function(){return function(e){return O(e,"session")&&Xe.resetSessionOffset(),Xe.updateLastActive(),Zt()}(t)})).then((function(){return nn.running?{}:un()}))}function an(){var e=nn.pause||{},t=e.timestamp,n=e.wait,r=Date.now()-(t||0);return r<n?n-r:null}function un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cleanUp,n=e.wait;if(nn.running)return Promise.resolve({});nn.running=!0;var r=Promise.resolve({});return t&&(r=r.then(cn)),r.then((function(){return yt.getFirst(tn)})).then((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.timestamp,n=e.createdAt,r=e.url,o=e.method,i=e.params,u=arguments.length>1?arguments[1]:void 0,s=Xe.current||{},c="/session"===r&&!s.installed;return en&&!c||!r&&!o&&!i?(nn.running=!1,Promise.resolve({})):$t.send({url:r,method:o,params:a(a({},i),{},{createdAt:_e(n||t)}),wait:u||an()})}(e,n)}))}function sn(e){if(void 0!==e)if(e!==en){var t=en;en=e,!e&&t&&un(),Y.info("The app is now in ".concat(e?"offline":"online"," mode"))}else Y.error("The app is already in ".concat(e?"offline":"online"," mode"));else Y.error("State not provided, true or false has to be defined")}function cn(){var e=Date.now()-ee.requestValidityWindow;return yt.deleteBulk(tn,e,"upperBound")}var ln="globalParams",dn={short:"No type provided",long:"Global parameter type not provided, `callback` or `partner` types are available"};function fn(e){return(e||[]).map((function(e){return{key:e.key,value:e.value}}))}function mn(){return Promise.all([yt.filterBy(ln,"callback"),yt.filterBy(ln,"partner")]).then((function(e){var t=S(e,2),n=t[0],r=t[1];return{callbackParams:fn(n),partnerParams:fn(r)}}))}function pn(e,t){if(void 0===t)return Y.error(dn.long),Promise.reject({message:dn.short});var n=I(e),r=Object.keys(n).map((function(e){return{key:e,value:n[e],type:t}}));return Promise.all([yt.filterBy(ln,t),yt.addBulk(ln,r,!0)]).then((function(e){var n=S(e,2),o=n[0],i=n[1],a=E(o.map((function(e){return e.key})),i.map((function(e){return e[0]})));return Y.log("Following ".concat(t," parameters have been saved: ").concat(r.map((function(e){return"".concat(e.key,":").concat(e.value)})).join(", "))),a.length&&Y.log("Keys: ".concat(a.join(", ")," already existed so their values have been updated")),i}))}function vn(e,t){return void 0===t?(Y.error(dn.long),Promise.reject({message:dn.short})):yt.deleteItem(ln,[e,t]).then((function(n){return Y.log("".concat(e," ").concat(t," parameter has been deleted")),n}))}function hn(e){return void 0===e?(Y.error(dn.long),Promise.reject({message:dn.short})):yt.deleteBulk(ln,e).then((function(t){return Y.log("All ".concat(e," parameters have been deleted")),t}))}var gn,yn,bn,kn=!1,Sn=document;function wn(){return bn=function(){var e=document;if(void 0!==e.hidden)return{hidden:"hidden",visibilityChange:"visibilitychange"};for(var t=A({mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange",oHidden:"ovisibilitychange",webkitHidden:"webkitvisibilitychange"}),n=0;n<t.length;n+=1){var r=S(t[n],2),o=r[0],i=r[1];if(void 0!==e[o])return{hidden:o,visibilityChange:i}}return null}(),kn?Promise.reject({interrupted:!0,message:"Session watch already initiated"}):(kn=!0,Le("session:finished",En),bn&&Ct(Sn,bn.visibilityChange,Nn),bn&&Sn[bn.hidden]?(Y.log("Session request attempt canceled because the tab is still hidden"),Promise.resolve({})):(Xe.initParams(),Rn()))}function Pn(){return On(),Xe.updateSessionOffset(),Xe.toBackground(),Zt()}function Dn(){return yt.getFirst(zt).then((function(e){var t=Xe.current,n=t.lastActive||0;if(Xt()&&n<e.lastActive){var r=!t.installed&&e.installed,o=(t.sessionCount||0)<(e.sessionCount||0);(r||o)&&Ke("sdk:installed"),Xe.current=e,at()}return e})).then((function(){Xe.updateSessionLength(),Xe.toForeground()})).then(Rn)}function Nn(){clearTimeout(yn);var e=bn&&Sn[bn.hidden]?Pn:Dn;yn=setTimeout(e,0)}function In(){bn&&!Sn[bn.hidden]&&(at(),kn||"on"!==Yt()||(jt(Sn,bn.visibilityChange,In),ur.__internal__.restartAfterAsyncEnable()))}function En(e,t){if(!t||"error"!==t.status)return Xe.updateInstalled(),Zt().then((function(){return Ke("sdk:installed")}));Y.error("Session was not successful, error was returned from the server:",t.response)}function On(){clearInterval(gn)}function Rn(){On(),gn=setInterval((function(){return Xe.updateSessionOffset(),Zt()}),ee.sessionTimerWindow);var e=Xe.current,t=e.lastInterval,n=e.sessionCount>0;return!n||n&&t*u>=ee.sessionWindow?mn().then((function(e){var t,n,r;on({url:"/session",method:"POST",params:(t=e,n=t.callbackParams,r=t.partnerParams,{callbackParams:n.length?I(n):null,partnerParams:r.length?I(r):null})},{auto:!0})})):(Ke("attribution:check"),Zt())}var An=Mt({url:"/attribution",strategy:"short",continueCb:function(e,t,n){if(!e||e&&"error"===e.status)return t(),Promise.resolve({state:"unknown"});if(!e.ask_in)return t(),function(e){if(w(e)||!function(e){var t=e.adid,n=void 0===t?"":t,r=e.attribution,o=void 0===r?{}:r;return!!n&&!!E(xn,Object.keys(o)).length}(e)||function(e){var t=e.adid,n=e.attribution,r=Xe.current.attribution||{},o=n&&xn.some((function(e){return r[e]!==n[e]}));return!o&&t===r.adid}(e))return Promise.resolve({state:"same"});var t=A(e.attribution).filter((function(e){var t=S(e,1)[0];return-1!==xn.indexOf(t)})).reduce(R,{adid:e.adid});return Xe.current=a(a({},Xe.current),{},{attribution:t}),Zt().then((function(){return Ke("attribution:change",t),Ke(y.ATTRIBUTION_RECEIVED,t),Y.info("Attribution has been updated"),{state:"changed"}}))}(e);return n(e.ask_in)}}),xn=["tracker_token","tracker_name","network","campaign","adgroup","creative","click_label","state"];var Cn=Mt({url:"/gdpr_forget_device",method:"POST",strategy:"short"}),jn={running:"Adjust SDK is running pending GDPR Forget Me request",pending:"Adjust SDK will run GDPR Forget Me request after initialisation",paused:"Adjust SDK is already prepared to send GDPR Forget Me request",off:"Adjust SDK is already disabled"};function _n(e){var t=Yt();return e||"on"===t?ee.isInitialised()?(Cn.send({params:a({},Xe.getParams())}).then((function(){Ke("sdk:gdpr-forget-me")})),!0):(Y.log(jn.pending),!0):(Y.log(jn[t]),!1)}function Tn(){return Vt({reason:d.REASON_GDPR,pending:!1},"finish")}var Bn=[];function Un(e,t){Bn.push({method:e,description:t,timestamp:Date.now()})}var Ln=10,Kn="eventDeduplication";function qn(e,t){var n,r,o=t.callbackParams,i=t.partnerParams,u={},s=a({eventToken:e.eventToken,deduplicationId:e.deduplicationId},(n=e.revenue,r=e.currency,isNaN(n)||(n=parseFloat(n))<0||!r?{}:{revenue:n.toFixed(5),currency:r})),c=a(a({},I(o)),I(e.callbackParams)),l=a(a({},I(i)),I(e.partnerParams));return w(c)||(u.callbackParams=c),w(l)||(u.partnerParams=l),a(a({},s),u)}function Gn(e){return e?yt.getAll(Kn).then((function(e){return e.map((function(e){return e.id}))})).then((function(t){return-1===t.indexOf(e)?function(e){var t=ee.getCustomConfig().eventDeduplicationListLimit,n=t>0?t:Ln;return yt.count(Kn).then((function(e){var t=Promise.resolve();if(e>=n){var r=e-n+1;Y.log("Event deduplication list limit has been reached. Oldest ids are about to be removed (".concat(r," of them)")),t=yt.trimItems(Kn,r)}return t})).then((function(){return Y.info("New event deduplication id is added to the list: ".concat(e)),yt.addItem(Kn,{id:e})}))}(e):Promise.reject({message:"Event won't be tracked, since it was previously tracked with the same deduplication id ".concat(e)})})):Promise.resolve()}function Mn(e){return{clickTime:_e(),source:"web_referrer",referrer:decodeURIComponent(e)}}function Fn(e,t){var n;(n=e||window.location.search.substring(1).split("&").map((function(e){return e.split("=")})).reduce(R,{}).adjust_referrer)&&on({url:"/sdk_click",method:"POST",params:Mn(n)},{timestamp:t})}var Wn=["logLevel","logOutput"],Vn=null,Hn=!1,Yn=!1,zn=!1,Jn=null;function Qn(e){ar("third-party sharing",(function(){return Xe.waitForWebUUID().then((function(){return function(e){e&&void 0!==e.isEnabled?on({url:"/third_party_sharing",method:"POST",params:{sharing:e.isEnabled?"enable":"disable",granularThirdPartySharingOptions:e.granularOptions,partnerSharingSettings:e.partnerSharingSettings}}):Y.error("Can not track third-party sharing without parameters")}(e)}))}),{schedule:!1,optionalInit:!0})}function Xn(){var e;"paused"===Yt()&&(Tn(),Promise.all([(e={uuid:"unknown"},Xe.current=e,yt.clear(zt).then((function(){return yt.addItem(zt,e)}))),yt.clear(ln),yt.clear(tn)]).then(tr))}function Zn(){return Hn||ee.isInitialised()}function $n(){Hn=!1,Yn=!1,Bn=[],$t.clear(),nn.running=!1,nn.timestamp=null,nn.pause=null,kn=!1,Xe.toBackground(),On(),bn&&(clearTimeout(yn),jt(Sn,bn.visibilityChange,Nn),Ct(Sn,bn.visibilityChange,In)),An.clear()}function er(e){e&&Y.log("Adjust SDK has been shutdown due to asynchronous disable"),$n(),Ue.forEach(clearTimeout),Ue=[],Be={},Xe.destroy(),jt(window,"online",At),jt(window,"offline",xt),yt.destroy(),ee.destroy()}function tr(){zn=!1,er(),Cn.clear(),Vn=null,Y.log("Adjust SDK instance has been destroyed")}function nr(e){Y.log("Adjust SDK is starting with web_uuid set to ".concat(e.uuid));var t=Xe.current.installed;"paused"===Yt()&&(Y.log(jn.running),_n(!0));var n=Yt(),r=function(e){return"Adjust SDK start has been interrupted ".concat(e)};return"off"===n?(er(),Promise.reject({interrupted:!0,message:r("due to complete async disable")})):"paused"===n?($n(),Promise.reject({interrupted:!0,message:r("due to partial async disable")})):Yn?Promise.reject({interrupted:!0,message:r("due to multiple synchronous start attempt")}):(un({cleanUp:!0}),wn().then((function(){Hn=!1,Yn=!0,t&&rr()})))}function rr(){var e;zn=!0,Bn.forEach((function(e){"function"==typeof e.method&&(Y.log("Delayed ".concat(e.description," task is running now")),e.method(e.timestamp))})),Bn=[],(e=Jn)&&A(Be).some((function(t){var n=S(t,2)[1];return n.some((function(t,r){t.id===e&&n.splice(r,1)}))}))}function or(e){if(e.interrupted)Y.log(e.message);else if(er(),Y.error("Adjust SDK start has been canceled due to an error",e),e.stack)throw e}function ir(e){"off"!==Yt()?(ee.set(e),Ct(window,"online",At),Ct(window,"offline",xt),Jn=Le("sdk:installed",rr),Le("sdk:shutdown",(function(){return er(!0)})),Le("sdk:gdpr-forget-me",Xn),Le("attribution:check",(function(e,t){return n=t,r=Xe.current,(o=(n||{}).ask_in)||!r.attribution&&r.installed?(An.send({params:a({initiatedBy:n?"backend":"sdk"},Xe.getParams()),wait:o}),Xe.updateSessionOffset(),Zt()):Promise.resolve(r);var n,r,o})),"function"==typeof e.attributionCallback&&Le("attribution:change",e.attributionCallback),(Jt?Promise.reject({interrupted:!0,message:"Adjust SDK start already in progress"}):(Jt=!0,yt.getFirst(zt).then(Qt).then((function(e){if(e.exists)return Jt=!1,e.stored;var t,n=w(Xe.current)?{uuid:(t=Date.now(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:11&n).toString(16)})))}:Xe.current;return yt.addItem(zt,n).then((function(){return Xe.init(n),at(),Jt=!1,n}))})).then((function(e){return Ke(y.WEB_UUID_CREATED,e?e.uuid:"gdpr_forgotten"),e})))).then(nr).then(Fn).catch(or)):Y.log("Adjust SDK is disabled, can not start the sdk")}function ar(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.schedule,o=n.waitForInitFinished,i=n.optionalInit;if(yt.getType()!==m.NO_STORAGE)if("on"===Yt())if(i||Zn()||!o){if("function"==typeof t){if(!r||zn&&Yn||!i&&!Zn())return t();Un(t,e),Y.log("Running ".concat(e," is delayed until Adjust SDK is up"))}}else Y.error("Adjust SDK can not ".concat(e,", sdk instance is not initialized"));else Y.log("Adjust SDK is disabled, can not ".concat(e));else Y.log("Adjust SDK can not ".concat(e,", no storage available"))}const ur={initSdk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.logLevel,n=e.logOutput,r=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Wn);Y.setLogLevel(t,n),Zn()?Y.error("You already initiated your instance"):ee.hasMissing(r)||(Hn=!0,yt.init(r.namespace).then((function(e){e.type!==m.NO_STORAGE?(Y.info("Available storage is ".concat(e.type)),Vn=a({},r),ir(r)):Y.error("Adjust SDK can not start, there is no storage available")})))},getAttribution:function(){return ar("get attribution",(function(){return Xe.getAttribution()}))},getWebUUID:function(){return ar("get web_uuid",(function(){return Xe.getWebUUID()}))},waitForAttribution:function(){return ar("get attribution",(function(){return Xe.waitForAttribution()}),{schedule:!1})},waitForWebUUID:function(){return ar("get web_uuid",(function(){return Xe.waitForWebUUID()}),{schedule:!1})},setReferrer:function(e){e&&"string"==typeof e?ar("setting reftag",(function(t){return Fn(e,t)}),{schedule:!0,waitForInitFinished:!0,optionalInit:!0}):Y.error("You must provide a string referrer")},trackEvent:function(e){return function(e){if(yt.getType()===m.NO_STORAGE){var t="Adjust SDK can not track event, no storage available";return Y.log(t),Promise.reject(t)}if("on"!==Yt()){var n="Adjust SDK is disabled, can not track event";return Y.log(n),Promise.reject(n)}if(!Zn()){var r="Adjust SDK can not track event, sdk instance is not initialized";return Y.error(r),Promise.reject(r)}return new Promise((function(t){var n=function(n){return t(function(e,t){if(!e||e&&(w(e)||!e.eventToken)){var n="You must provide event token in order to track event";return Y.error(n),Promise.reject(n)}return Gn(e.deduplicationId).then(mn).then((function(n){return on({url:"/event",method:"POST",params:qn(e,n)},{timestamp:t})})).catch((function(e){return e&&e.message&&Y.error(e.message),Promise.reject(e)}))}(e,n))};!zn||!Yn&&Zn()?(Un(n,"track event"),Y.log("Running track event is delayed until Adjust SDK is up")):n()}))}(e)},addGlobalCallbackParameters:function(e){ar("add global callback parameters",(function(){return pn(e,"callback")}))},addGlobalPartnerParameters:function(e){ar("add global partner parameters",(function(){return pn(e,"partner")}))},removeGlobalCallbackParameter:function(e){ar("remove global callback parameter",(function(){return vn(e,"callback")}))},removeGlobalPartnerParameter:function(e){ar("remove global partner parameter",(function(){return vn(e,"partner")}))},clearGlobalCallbackParameters:function(){ar("remove all global callback parameters",(function(){return hn("callback")}))},clearGlobalPartnerParameters:function(){ar("remove all global partner parameters",(function(){return hn("partner")}))},switchToOfflineMode:function(){ar("set offline mode",(function(){return sn(!0)}))},switchBackToOnlineMode:function(){ar("set online mode",(function(){return sn(!1)}))},stop:function(){Ht()&&ee.isInitialised()&&er()},restart:function(){var e;((e=(ot()||{}).reason)===d.REASON_GDPR?(Y.log("Adjust SDK is disabled due to GDPR-Forget-Me request and it can not be re-enabled"),!1):e?(Y.log("Adjust SDK has been enabled"),it(null),!0):(Y.log("Adjust SDK is already enabled"),!1))&&Vn&&ir(Vn)},gdprForgetMe:function(){var e=_n();e&&(e=Ht(d.REASON_GDPR,!0))&&ee.isInitialised()&&$n()},disableThirdPartySharing:function(){Qn({isEnabled:!1})},trackThirdPartySharing:Qn,ThirdPartySharing:function(){return Ce((function e(t){Ae(this,e),o(this,"_granularOptions",{}),o(this,"_partnerSharingSettings",{}),"boolean"!=typeof t&&Y.warn("isEnabled should be boolean, converting ".concat(t," results ").concat(!!t)),this._isEnabled=!!t}),[{key:"isEnabled",get:function(){return this._isEnabled}},{key:"granularOptions",get:function(){return this._granularOptions}},{key:"partnerSharingSettings",get:function(){return this._partnerSharingSettings}},{key:"addGranularOption",value:function(e,t,n){if(e&&t&&void 0!==n){var r=o({},t,n);this.granularOptions[e]?this.granularOptions[e]=a(a({},this.granularOptions[e]),r):this.granularOptions[e]=r}else Y.error("Cannot add granular option, partnerName, key and value are mandatory")}},{key:"addPartnerSharingSetting",value:function(e,t,n){if(e&&t&&void 0!==n){var r=o({},t,n);this.partnerSharingSettings[e]?this.partnerSharingSettings[e]=a(a({},this.partnerSharingSettings[e]),r):this.partnerSharingSettings[e]=r}else Y.error("Cannot add partner sharing setting, partnerName, key and value are mandatory")}}])}(),initSmartBanner:function(){Y.error("function `initSmartBanner` is deprecated")},showSmartBanner:function(){Y.error("function `showSmartBanner` is deprecated")},hideSmartBanner:function(){Y.error("function `hideSmartBanner` is deprecated")},__testonly__:{destroy:tr,clearDatabase:function(){return yt.deleteDatabase()}},__internal__:{restartAfterAsyncEnable:function(){Y.log("Adjust SDK has been restarted due to asynchronous enable"),Vn&&ir(Vn)}}};return t=t.default})()));